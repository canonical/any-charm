# Copyright 2024 Canonical Ltd.
# See LICENSE file for licensing details.

type: charm
platforms:
  ubuntu@22.04:amd64:
  ubuntu@22.04:arm64:
  ubuntu@22.04:s390x:
  ubuntu@22.04:ppc64el:
  ubuntu@24.04:amd64:
  ubuntu@24.04:arm64:
  ubuntu@24.04:s390x:
  ubuntu@24.04:ppc64el:

parts:
  charm: {}
  wheelhouse:
    plugin: nil
    source: .
    build-packages:
      - python3-pip
    override-build: |
      mkdir -p $CRAFT_PART_INSTALL/wheelhouse
      cp $CRAFT_PART_SRC/wheelhouse.txt $CRAFT_PART_INSTALL
      for package in $(cat $CRAFT_PART_SRC/wheelhouse.txt)
      do
        pip wheel --wheel-dir=$CRAFT_PART_INSTALL/wheelhouse --prefer-binary $package
      done
